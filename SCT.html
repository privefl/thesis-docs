<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>SCT</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link href="libs/font-awesome/css/fontawesome-all.min.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">




class: title-slide center middle inverse

# Stacked Clumping and Thresholding (SCT)

## Making the most of C+T for polygenic scores

&lt;br&gt;

### Florian Priv√©

---

## Standard PRS - part 1: estimating effects

### Genome-wide association studies (GWAS)

In a GWAS, each single-nucleotide polymorphism (SNP) is tested **independently**, resulting in one **effect size** `\(\hat\beta\)` and one **p-value** `\(p\)` for each SNP. 

&lt;img src="figures/gwas-height-20K.png" width="95%" style="display: block; margin: auto;" /&gt;

Easy combining: `\(PRS_i = \sum_j \hat\beta_j \cdot G_{i,j}\)`

---

## Standard PRS - part 2: restricting predictors

### &lt;span style="color:#38761D"&gt;Clumping&lt;/span&gt; + &lt;span style="color:#1515FF"&gt;Thresholding&lt;/span&gt; (C+T)

&lt;br&gt;

&lt;img src="figures/GWAS2PRS3.png" width="100%" style="display: block; margin: auto;" /&gt;

&lt;br&gt;

`$$PRS_i = \sum_{\substack{j \in S_\text{clumping} \\ p_j~&lt;~p_T}} \hat\beta_j \cdot G_{i,j}$$`

---

## Hyper-parameters in C+T

- threshold on squared correlation of clumping ( `\(r_c^2 \sim 0.2\)` ) and    
window size for LD computation ( `\(w_c \sim 500 kb\)` )

- p-value threshold ( `\(p_T\)` between `\(1\)` and `\(10^{-8}\)` and choose the best one )

--

- threshold of imputation quality score ( `\(INFO_T \sim 0.3\)` )

--

`\(\Longrightarrow\)` *stdCT* (standard C+T)

&lt;br&gt;

--

#### Our contribution

- an efficient implementation to compute many C+T scores for different hyper-parameters (5600 sets of hyper-parameters `\(\times\)` 22 chromosomes)    
`\(\Longrightarrow\)` *maxCT* (maximized C+T)

--

- going further by stacking all C+T models (instead of just choosing the best model)    
`\(\Longrightarrow\)` *SCT* (Stacked C+T)

---

## Stacking with penalized logistic regression

&lt;br&gt;

&lt;Small&gt;$$\arg\!\min_{\beta_0,~\beta}(\lambda, \alpha)\left\{  \underbrace{ -\sum_{i=1}^n \left( y_i \log\left(p_i\right) + (1 - y_i) \log\left(1 - p_i\right) \right) }_\text{Loss function}   +   \underbrace{ \lambda \left((1-\alpha)\frac{1}{2}\|\beta\|_2^2 + \alpha \|\beta\|_1\right) }_\text{Penalization}  \right\}$$&lt;/Small&gt;

&lt;br&gt;

***

- `\(p_i=1/\left(1+\exp\left(-(\beta_0 + x_i^T\beta)\right)\right)\)`

- `\(x\)` is denoting the **C+T scores** and covariates (e.g. principal components), 

- `\(y\)` is the disease status we want to predict, 

- `\(\lambda\)` is a regularization parameter that needs to be determined and

- `\(\alpha\)` determines relative parts of the regularization `\(0 \le \alpha \le 1\)`. 

---

## Results (simulations)

<div id="htmlwidget-4a86fd4bae978a44e9a9" style="width:90%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4a86fd4bae978a44e9a9">{"x":{"data":[{"x":[0.4,6.6],"y":[0.5,0.5],"text":"yintercept: 0.5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"dash"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.4,6.6],"y":[0.875,0.875],"text":"yintercept: 0.875","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,255,1)","dash":"dot"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.225,0.225,0.225000000000001,0.225000000000001,0.225,0.225],"base":[0,0,0,0,0,0],"x":[0.6625,1.6625,2.6625,3.6625,4.6625,5.6625],"y":[0.798164665410732,0.724859309194675,0.68902790026649,0.772414382318031,0.69753141392844,0.787442566428777],"text":["simu: 100<br />mean: 0.7981647<br />Method: stdCT<br />Method: black","simu: 10K<br />mean: 0.7248593<br />Method: stdCT<br />Method: black","simu: 1M<br />mean: 0.6890279<br />Method: stdCT<br />Method: black","simu: 2chr<br />mean: 0.7724144<br />Method: stdCT<br />Method: black","simu: err<br />mean: 0.6975314<br />Method: stdCT<br />Method: black","simu: HLA<br />mean: 0.7874426<br />Method: stdCT<br />Method: black"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(68,1,84,0.5)","line":{"width":3.77952755905512,"color":"rgba(0,0,0,1)"}},"name":"(stdCT,1)","legendgroup":"(stdCT,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.225,0.225,0.225,0.225,0.225,0.225],"base":[0,0,0,0,0,0],"x":[0.8875,1.8875,2.8875,3.8875,4.8875,5.8875],"y":[0.869434407362376,0.750790575588277,0.69456987142473,0.786093667614732,0.706871622833797,0.797559539496272],"text":["simu: 100<br />mean: 0.8694344<br />Method: maxCT<br />Method: black","simu: 10K<br />mean: 0.7507906<br />Method: maxCT<br />Method: black","simu: 1M<br />mean: 0.6945699<br />Method: maxCT<br />Method: black","simu: 2chr<br />mean: 0.7860937<br />Method: maxCT<br />Method: black","simu: err<br />mean: 0.7068716<br />Method: maxCT<br />Method: black","simu: HLA<br />mean: 0.7975595<br />Method: maxCT<br />Method: black"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(42,120,142,0.5)","line":{"width":3.77952755905512,"color":"rgba(0,0,0,1)"}},"name":"(maxCT,1)","legendgroup":"(maxCT,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.225,0.225,0.225,0.225,0.225,0.225],"base":[0,0,0,0,0,0],"x":[1.1125,2.1125,3.1125,4.1125,5.1125,6.1125],"y":[0.862876237405678,0.760334392185003,0.690193108489468,0.822378361041697,0.731957836727755,0.807408196533854],"text":["simu: 100<br />mean: 0.8628762<br />Method: SCT<br />Method: black","simu: 10K<br />mean: 0.7603344<br />Method: SCT<br />Method: black","simu: 1M<br />mean: 0.6901931<br />Method: SCT<br />Method: black","simu: 2chr<br />mean: 0.8223784<br />Method: SCT<br />Method: black","simu: err<br />mean: 0.7319578<br />Method: SCT<br />Method: black","simu: HLA<br />mean: 0.8074082<br />Method: SCT<br />Method: black"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(122,209,81,0.5)","line":{"width":3.77952755905512,"color":"rgba(0,0,0,1)"}},"name":"(SCT,1)","legendgroup":"(SCT,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.225,0.225,0.225000000000001,0.225,0.225,0.225],"base":[0,0,0,0,0,0],"x":[1.3375,2.3375,3.3375,4.3375,5.3375,6.3375],"y":[0.831709513143147,0.749196866824013,0.704226039287864,0.789275989426245,0.721492933541239,0.794445313918173],"text":["simu: 100<br />mean: 0.8317095<br />Method: lassosum<br />Method: black","simu: 10K<br />mean: 0.7491969<br />Method: lassosum<br />Method: black","simu: 1M<br />mean: 0.7042260<br />Method: lassosum<br />Method: black","simu: 2chr<br />mean: 0.7892760<br />Method: lassosum<br />Method: black","simu: err<br />mean: 0.7214929<br />Method: lassosum<br />Method: black","simu: HLA<br />mean: 0.7944453<br />Method: lassosum<br />Method: black"],"type":"bar","marker":{"autocolorscale":false,"color":"rgba(253,231,37,0.5)","line":{"width":3.77952755905512,"color":"rgba(0,0,0,1)"}},"name":"(lassosum,1)","legendgroup":"(lassosum,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.6625,1.6625,2.6625,3.6625,4.6625,5.6625],"y":[0.798164665410732,0.724859309194675,0.68902790026649,0.772414382318031,0.69753141392844,0.787442566428777],"text":["inf: 0.7696531<br />sup: 0.8198489<br />simu: 100<br />mean: 0.7981647<br />Method: stdCT<br />Method: black","inf: 0.7174111<br />sup: 0.7324153<br />simu: 10K<br />mean: 0.7248593<br />Method: stdCT<br />Method: black","inf: 0.6834069<br />sup: 0.6941701<br />simu: 1M<br />mean: 0.6890279<br />Method: stdCT<br />Method: black","inf: 0.7668903<br />sup: 0.7774006<br />simu: 2chr<br />mean: 0.7724144<br />Method: stdCT<br />Method: black","inf: 0.6888782<br />sup: 0.7066029<br />simu: err<br />mean: 0.6975314<br />Method: stdCT<br />Method: black","inf: 0.7801974<br />sup: 0.7950133<br />simu: HLA<br />mean: 0.7874426<br />Method: stdCT<br />Method: black"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_y":{"array":[0.0216841920765181,0.00755602765469632,0.00514217988824939,0.00498620700661667,0.00907149940318663,0.00757069669104038],"arrayminus":[0.0285115886025232,0.00744817021832245,0.0056210314065539,0.00552407697065171,0.00865322024300685,0.00724512830702551],"type":"data","width":1.35483870967742,"symmetric":false,"color":"rgba(0,0,0,1)"},"name":"(stdCT,1)","legendgroup":"(stdCT,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.8875,1.8875,2.8875,3.8875,4.8875,5.8875],"y":[0.869434407362376,0.750790575588277,0.69456987142473,0.786093667614732,0.706871622833797,0.797559539496272],"text":["inf: 0.8658349<br />sup: 0.8730082<br />simu: 100<br />mean: 0.8694344<br />Method: maxCT<br />Method: black","inf: 0.7466608<br />sup: 0.7547077<br />simu: 10K<br />mean: 0.7507906<br />Method: maxCT<br />Method: black","inf: 0.6882127<br />sup: 0.7003026<br />simu: 1M<br />mean: 0.6945699<br />Method: maxCT<br />Method: black","inf: 0.7797196<br />sup: 0.7916567<br />simu: 2chr<br />mean: 0.7860937<br />Method: maxCT<br />Method: black","inf: 0.7006203<br />sup: 0.7121172<br />simu: err<br />mean: 0.7068716<br />Method: maxCT<br />Method: black","inf: 0.7914800<br />sup: 0.8032334<br />simu: HLA<br />mean: 0.7975595<br />Method: maxCT<br />Method: black"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_y":{"array":[0.00357379926419943,0.00391712065973904,0.00573268677422489,0.00556299869279298,0.00524555543287741,0.00567386167168404],"arrayminus":[0.00359949602354104,0.00412976799789799,0.00635721206161266,0.00637410226165325,0.00625133631351149,0.00607954588419235],"type":"data","width":1.35483870967742,"symmetric":false,"color":"rgba(0,0,0,1)"},"name":"(maxCT,1)","legendgroup":"(maxCT,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.1125,2.1125,3.1125,4.1125,5.1125,6.1125],"y":[0.862876237405678,0.760334392185003,0.690193108489468,0.822378361041697,0.731957836727755,0.807408196533854],"text":["inf: 0.8581290<br />sup: 0.8678016<br />simu: 100<br />mean: 0.8628762<br />Method: SCT<br />Method: black","inf: 0.7547763<br />sup: 0.7659458<br />simu: 10K<br />mean: 0.7603344<br />Method: SCT<br />Method: black","inf: 0.6853868<br />sup: 0.6956533<br />simu: 1M<br />mean: 0.6901931<br />Method: SCT<br />Method: black","inf: 0.8176603<br />sup: 0.8270532<br />simu: 2chr<br />mean: 0.8223784<br />Method: SCT<br />Method: black","inf: 0.7250626<br />sup: 0.7388598<br />simu: err<br />mean: 0.7319578<br />Method: SCT<br />Method: black","inf: 0.8022539<br />sup: 0.8127131<br />simu: HLA<br />mean: 0.8074082<br />Method: SCT<br />Method: black"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_y":{"array":[0.00492538094947292,0.00561139168887004,0.0054601773236107,0.00467482049681633,0.00690192194428818,0.00530488901120141],"arrayminus":[0.00474719356366737,0.00555806159386407,0.00480631505749751,0.00471806951665665,0.00689523998406716,0.00515429112513488],"type":"data","width":1.35483870967742,"symmetric":false,"color":"rgba(0,0,0,1)"},"name":"(SCT,1)","legendgroup":"(SCT,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.3375,2.3375,3.3375,4.3375,5.3375,6.3375],"y":[0.831709513143147,0.749196866824013,0.704226039287864,0.789275989426245,0.721492933541239,0.794445313918173],"text":["inf: 0.8178239<br />sup: 0.8416120<br />simu: 100<br />mean: 0.8317095<br />Method: lassosum<br />Method: black","inf: 0.7427068<br />sup: 0.7560129<br />simu: 10K<br />mean: 0.7491969<br />Method: lassosum<br />Method: black","inf: 0.7004161<br />sup: 0.7084799<br />simu: 1M<br />mean: 0.7042260<br />Method: lassosum<br />Method: black","inf: 0.7836860<br />sup: 0.7938678<br />simu: 2chr<br />mean: 0.7892760<br />Method: lassosum<br />Method: black","inf: 0.7151768<br />sup: 0.7282370<br />simu: err<br />mean: 0.7214929<br />Method: lassosum<br />Method: black","inf: 0.7867500<br />sup: 0.8021451<br />simu: HLA<br />mean: 0.7944453<br />Method: lassosum<br />Method: black"],"type":"scatter","mode":"lines","opacity":1,"line":{"color":"transparent"},"error_y":{"array":[0.00990250598274578,0.00681604778184886,0.00425390309949902,0.00459179127991038,0.00674408646790803,0.00769977245530606],"arrayminus":[0.0138856017757852,0.00649011467451732,0.00380992119127976,0.00559000158881018,0.00631611039924662,0.00769532617830249],"type":"data","width":1.35483870967742,"symmetric":false,"color":"rgba(0,0,0,1)"},"name":"(lassosum,1)","legendgroup":"(lassosum,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":23.3059360730594,"r":7.30593607305936,"b":50.4109589041096,"l":59.1780821917808},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,6.6],"tickmode":"array","ticktext":["100","10K","1M","2chr","err","HLA"],"tickvals":[1,2,3,4,5,6],"categoryorder":"array","categoryarray":["100","10K","1M","2chr","err","HLA"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":17.5342465753425},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"Simulation","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":21.9178082191781},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.48,0.92],"tickmode":"array","ticktext":["0.5","0.6","0.7","0.8","0.9"],"tickvals":[0.5,0.6,0.7,0.8,0.9],"categoryorder":"array","categoryarray":["0.5","0.6","0.7","0.8","0.9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":17.5342465753425},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"AUC","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":21.9178082191781},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":18.9954337899543},"y":0.888638920134983},"annotations":[{"text":"Method","x":1.02,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":26.3013698630137},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"left","yanchor":"bottom","legendTitle":true}],"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"source":"A","attrs":{"12c7261f3208":{"yintercept":{},"type":"scatter"},"12c75a77ebc8":{"yintercept":{}},"12c729039c71":{"x":{},"y":{},"fill":{},"colour":{}},"12c7354b59d9":{"ymin":{},"ymax":{},"x":{},"y":{},"fill":{},"colour":{}}},"cur_data":"12c7261f3208","visdat":{"12c7261f3208":["function (y) ","x"],"12c75a77ebc8":["function (y) ","x"],"12c729039c71":["function (y) ","x"],"12c7354b59d9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":[]}</script>

---

## Results (real data)

&lt;img src="figures/SCT-AUC-real.png" width="3000" style="display: block; margin: auto;" /&gt;

---

## Results (grid of hyper-parameters for MDD)

&lt;br&gt;
&lt;br&gt;

&lt;img src="https://raw.githubusercontent.com/privefl/simus-PRS/master/figures/grid-MDD.png" width="120%" style="display: block; margin: auto;" /&gt;

---

class: center, middle, inverse

# Thanks!

&lt;br&gt;

Presentation available at

https://privefl.github.io/thesis-docs/SCT.html

&lt;br&gt;

<i class="fab  fa-twitter "></i> [privefl](https://twitter.com/privefl) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <i class="fab  fa-github "></i> [privefl](https://github.com/privefl) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <i class="fab  fa-stack-overflow "></i> [F. Priv√©](https://stackoverflow.com/users/6103040/f-priv%c3%a9)

.footnote[Slides created via R package [**xaringan**](https://github.com/yihui/xaringan).]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
