<!DOCTYPE html>
<html>
  <head>
    <title>Journées des doctorants</title>
    <meta charset="utf-8">
    <meta name="author" content="Florian Privé" />
    <meta name="date" content="2018-03-20" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Journées des doctorants
### Florian Privé
### March 20, 2018

---




## Outline 

### 1. Main objective of the thesis

### 2. R packages

### 3. Ongoing paper

### 4. Future work

---

class: center, middle, inverse

# Main objective

---

## Compute Polygenic Risk Scores (PRS) 
### in order to differentiate a healthy person from a diseased person

&lt;img src="figures/density-scores.svg" width="80%" style="display: block; margin: auto;" /&gt;

---

## 4 main difficulties

&lt;br&gt;

- Size of the data (dozens to hundreds of GB)

- Hundreds of thousands of correlated variables (variables with overlapping information)

- Generalization of models on different populations

- Integration of non-genetic data in the models

---

class: center, middle, inverse

# Big Data

### Simpler solutions are easier to implement

---

## What I want to be able to do

### Data analysis on large-scale genotype matrices!

- Be fast to test many ideas quickly

    - code should be fast
    - I shouldn't have to make many conversions
    - easily combine multiple functions
    
- Not be restricted in my analysis
   
    - Basically use all I already know in R
    
- Work on my computer

    - I have 64 GB of RAM and 12 cores
    - Working on a server is not as easy as on my computer

&lt;br&gt;&lt;center&gt;**Smooth and fast analysis!**

---

## Memory problem when working in R

&lt;br&gt;

&lt;img src="figures/memory-problem.svg" width="80%" style="display: block; margin: auto;" /&gt;

---

## Memory solution when working in R

&lt;br&gt;

&lt;img src="figures/memory-solution.svg" width="80%" style="display: block; margin: auto;" /&gt;

.footnote[I don't use **bigmemory** anymore but still something very similar.]

---

## Two R packages: bigstatsr and bigsnpr

### Statistical tools with big matrices stored on disk

&lt;br&gt;

- **bigstatsr** for many types of matrix, to be used by any field of research

- **bigsnpr** for functions that are specific to the analysis of genetic data

&lt;br&gt;

&lt;img src="figures/bigsnpr-submitted.png" width="95%" style="display: block; margin: auto;" /&gt;

---

## Comparative performance

### Computing partial SVD

&lt;img src="figures/benchmark-pca.png" width="80%" style="display: block; margin: auto;" /&gt;

---

class: center, middle, inverse

# Ongoing paper

### Comparison of methods for computing PRS

---

## Recall of what we want to achieve

### Predict a phenotype: pitfalls of the widely-used model

- Weigths learned independently

- Correlation is taken care of heuristically

- Regularization is taken care of heuristically

### A better solution?

We can use **statistical learning methods**.

For example, we can use logistic regression on all variables at once by using a clever implementation.

---

class: center, middle, inverse

# Future work

### UK Biobank

---

## UK Biobank

It is an extremely large dataset with 

 - genetic data
 
 - clinical data
 
 - environmental data

## Prospects

- training in one population to improve training and prediction in another population

- assess how can we combine the information provided by genetic data with clinical and environmental data, possibly in a non-linear way

---

class: center, middle, inverse

# Thanks!

&lt;br&gt;

Presentation available at

https://privefl.github.io/thesis-docs/JDD.html

&lt;br&gt;

<i class="fa  fa-twitter "></i> [privefl](https://twitter.com/privefl) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <i class="fa  fa-github "></i> [privefl](https://github.com/privefl) &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <i class="fa  fa-stack-overflow "></i> [F. Privé](https://stackoverflow.com/users/6103040/f-priv%c3%a9)

.footnote[Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
