---
title: "Suivi de thèse n°1"
author: "Florian Privé"
date: "September 28, 2017"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.align = "center", dev = "svg",
                      fig.asp = 0.7, out.width = "80%", echo = FALSE)
```

## Outline 

1. Main objective of the thesis

2. Data analyzed

3. R packages

4. Future work

---

class: center, middle, inverse

# Main objective

---

## Compute polygenic risk scores 
### in order to differentiate a healthy person from a diseased person

```{r}
knitr::include_graphics("figures/density-scores.jpeg")
```

---

## Usefulness

### Precision medecine

```{r, out.width="100%"}
knitr::include_graphics("https://www.ucdmc.ucdavis.edu/precision-medicine/images/pmSlide1.jpg")
```

.footnote[Source: https://www.ucdmc.ucdavis.edu/precision-medicine/]

---

## Data analyzed for now

### case/control cohort for the celiac disease

---

## Celiac disease

### Intolerance to gluten

```{r, out.width="60%"}
knitr::include_graphics("http://www.strettoweb.com/wp-content/uploads/2016/12/celiaci.jpg")
```

<center>is the only treatment.

---

## Celiac disease

### Prevalence of 1% in western countries but..

```{r, out.width="100%"}
knitr::include_graphics("https://www.beyondceliac.org/SiteData/images/FastFacts2/413d26a2a7026920/FastFacts_2.png")
```

.footnote[Source: https://www.beyondceliac.org/celiac-disease/facts-and-figures/]

---

## Celiac disease

### The dataset: SNP array with

</br>
```{r}
celiac.data <- tibble::tribble(
  ~Population,   ~UK, ~Finland, ~Netherlands, ~Italy, ~Total,
      "Cases",  2586,      647,          803,    497,   4533,
   "Controls",  7532,     1829,          846,    543,  10750,
      "Total", 10118,     2476,         1649,   1040,  15283
)
knitr::kable(celiac.data, format = "html", align = "lccccr")
```

</br>

<center>over ~300K SNPs</center>

</br>

This data would take **32GB** if stored in RAM as a standard R matrix.

---

class: center, middle, inverse

# Polygenic Risk Scores

---

## Standard model used in the human litterature

### P+T procedure, begins with a GWAS

```{r}
knitr::include_graphics("figures/celiac-gwas-cut.png")
```

<center>+ Pruning and Thresholding

---

### All steps required in the P+T procedure.

```{r}
knitr::include_graphics("figures/steps-PT.svg")
```

---

### PCA in GWAS?

<br><br>

```{r, out.width="70%", fig.cap="Inflated Q-Q plot when not correcting for population structure."}
knitr::include_graphics("figures/qqplot1.png")
```

---

### PCA in GWAS?

Principal Components to adjust for the condounding effect of population structure (Patterson,
Price, and Reich 2006).

```{r, out.width="70%", fig.cap="Less inflated Q-Q plot when correcting for population structure."}
knitr::include_graphics("figures/qqplot2.png")
```

---

## How to perform PCA for genetic data?

### On the whole (scaled) matrix

```{r, out.width="70%"}
knitr::include_graphics("figures/PC-1-2.png")
```

---

## How to perform PCA for genetic data?

### On the whole (scaled) matrix

```{r, out.width="70%"}
knitr::include_graphics("figures/PC-3-4.png")
```

---

## How to perform PCA for genetic data?

### On the whole (scaled) matrix **with pruning**

```{r, out.width="70%"}
knitr::include_graphics("figures/PC2-3-4.png")
```

---

## How to perform PCA for genetic data?

### On the whole (scaled) matrix **with pruning**

```{r, out.width="70%"}
knitr::include_graphics("figures/PC3-3-4.png")
```

---

## How to perform PCA for genetic data?

### On the whole (scaled) matrix **with pruning**

```{r, out.width="70%"}
knitr::include_graphics("figures/load3-3-4.png")
```

---

class: center, middle, inverse

# Thanks!

### Presentation available at
### https://privefl.github.io/R-presentation/suivi-these.html

.footnote[Slides created via the R package [**xaringan**](https://github.com/yihui/xaringan).]
